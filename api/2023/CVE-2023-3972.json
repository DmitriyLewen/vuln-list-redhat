{
  "mitigation": "Red Hat has investigated whether a possible mitigation exists for this issue, and has not been able to identify a practical example. Please update the affected package as soon as possible.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "insights-client",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "insights-client",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "insights-client",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "insights-client",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2023-11-01T11:00:00Z",
  "bugzilla": {
    "description": "unsafe handling of temporary files and directories",
    "id": "2227027",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2227027"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-61-\u003eCWE-379",
  "statement": "To exploit this CVE, in normal situations the attacker must have unprivileged access to the system before Insights is run for the first time on the system.\nSystems that are already running Insights on a regular frequent schedule should not consider themselves vulnerable. in other words, If Insights is registered before unprivileged users are given access, this specific problem doesn't appear to arise.",
  "acknowledgement": "This issue was discovered by Alasdair Kergon (Red Hat) and Pavel Odvody (Red Hat).",
  "name": "CVE-2023-3972",
  "document_distribution": "",
  "details": [
    "A vulnerability was found in insights-client. This security issue occurs because of insecure file operations or unsafe handling of temporary files and directories that lead to local privilege escalation. Before the insights-client has been registered on the system by root, an unprivileged local user or attacker could create the /var/tmp/insights-client directory (owning the directory with read, write, and execute permissions) on the system. After the insights-client is registered by root, an attacker could then control the directory content that insights are using by putting malicious scripts into it and executing arbitrary code as root (trivially bypassing SELinux protections because insights processes are allowed to disable SELinux system-wide)."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-3972\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-3972\nhttps://github.com/RedHatInsights/insights-core/pull/3878"
  ]
}