{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20243183",
  "Version": "636",
  "Metadata": {
    "Title": "freeipa: user can obtain a hash of the passwords of all domain users and perform offline brute force (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-3183",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-3183"
      }
    ],
    "Description": "DOCUMENTATION: A vulnerability was found in FreeIPA in a way when a Kerberos TGS-REQ is encrypted using the client’s session key. This key is different for each new session, which protects it from brute force attacks. However, the ticket it contains is encrypted using the target principal key directly. For user principals, this key is a hash of a public per-principal randomly-generated salt and the user’s password.\n\nIf a principal is compromised it means the attacker would be able to retrieve tickets encrypted to any principal, all of them being encrypted by their own key directly. By taking these tickets and salts offline, the attacker could run brute force attacks to find character strings able to decrypt tickets when combined to a principal salt (i.e. find the principal’s password). \n            STATEMENT: This kind of attacks primarily affect user principals, not service principals because their keys are usually generated randomly. But weak user passwords are particularly vulnerable to such attacks, especially if they are referenced in password dictionaries.\n            MITIGATION: To mitigate this vulnerability, ticket requests to user principals are now disallowed in FreeIPA realms by default. This will keep attackers from obtaining data encrypted with the user key directly.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2024-06-10"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-3183",
          "Cvss3": "8.1/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
          "Cwe": "CWE-916",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-3183",
          "Public": "20240610"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras:7",
        "cpe:/a:redhat:rhel_extras_oracle_java:7",
        "cpe:/a:redhat:rhel_extras_rt:7",
        "cpe:/a:redhat:rhel_extras_sap:7",
        "cpe:/a:redhat:rhel_extras_sap_hana:7",
        "cpe:/o:redhat:enterprise_linux:7",
        "cpe:/o:redhat:enterprise_linux:7::client",
        "cpe:/o:redhat:enterprise_linux:7::computenode",
        "cpe:/o:redhat:enterprise_linux:7::server",
        "cpe:/o:redhat:enterprise_linux:7::workstation"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python2-ipaserver is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850001"
                  },
                  {
                    "Comment": "python2-ipaserver is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-admintools is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850019"
                  },
                  {
                    "Comment": "ipa-admintools is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python2-ipalib is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850015"
                  },
                  {
                    "Comment": "python2-ipalib is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-server-dns is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850023"
                  },
                  {
                    "Comment": "ipa-server-dns is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-python is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850009"
                  },
                  {
                    "Comment": "ipa-python is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-python-compat is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850027"
                  },
                  {
                    "Comment": "ipa-python-compat is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python2-ipaclient is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850011"
                  },
                  {
                    "Comment": "python2-ipaclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-server-trust-ad is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850021"
                  },
                  {
                    "Comment": "ipa-server-trust-ad is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-server-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850003"
                  },
                  {
                    "Comment": "ipa-server-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850017"
                  },
                  {
                    "Comment": "ipa-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-client-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850013"
                  },
                  {
                    "Comment": "ipa-client-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850007"
                  },
                  {
                    "Comment": "ipa-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850005"
                  },
                  {
                    "Comment": "ipa is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-client is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20147850025"
                  },
                  {
                    "Comment": "ipa-client is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20147850026"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}