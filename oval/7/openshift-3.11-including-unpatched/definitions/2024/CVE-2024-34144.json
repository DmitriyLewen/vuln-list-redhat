{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202434144",
  "Version": "636",
  "Metadata": {
    "Title": "jenkins-plugin/script-security: sandbox bypass via crafted constructor bodies (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-34144",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-34144"
      }
    ],
    "Description": "DOCUMENTATION: A sandbox bypass vulnerability was found in the Jenkins Script Security Plugin involving crafted constructor bodies, enabling the circumvention of security restrictions. With crafted constructor bodies, this flaw allows authenticated attackers to define and execute sandboxed scripts, including Pipelines, bypassing sandbox protection mechanisms and executing arbitrary code within the context of the Jenkins controller JVM.\n\nThe Script Security Plugin features a sandbox functionality designed to enable users with limited privileges to create scripts, including Pipelines, which are generally safe for execution. This security mechanism intercepts calls within sandboxed scripts, referencing various allowlists to decide whether these calls should be permitted.\n\nThe vulnerabilities that allow for sandbox bypass have been identified in versions up to 1335.vf07d9ce377a_e of the Script Security Plugin. These vulnerabilities include:\n\n- Exploiting crafted constructor bodies that trigger other constructors, thereby allowing the construction of any subclassable type through implicit casts.\n- Utilizing Groovy classes defined within the sandbox that overshadow certain non-sandboxed classes, facilitating the creation of any subclassable type.\n\nThese vulnerabilities enable attackers, who have the permission to create and execute sandboxed scripts including Pipelines, to circumvent sandbox protections and execute arbitrary code within the context of the Jenkins controller JVM.\n\nThe fixed version of this script incorporates enhanced restrictions and sanity checks. These improvements ensure that calls to super constructors are intercepted by the sandbox, including:\n\n- Ensuring that calls to other constructors via 'this' are now appropriately managed within the sandbox.\n- No longer overlooking classes in packages that may be overshadowed by Groovy-defined classes when intercepting super constructor calls. \n            STATEMENT: Red Hat rates the security impact of this vulnerability as Important due to the worst case scenario resulting in a process being able to access resources outside an assigned sandbox.\n\nThe vulnerabilities that allow for sandbox bypass have been identified in versions up to 1335.vf07d9ce377a_e of the Script Security Plugin. These vulnerabilities include exploiting specially crafted constructor bodies, utilizing certain groovy classes.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2024-05-03"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-34144",
          "Cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-693",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-34144",
          "Public": "20240502"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:3.11",
        "cpe:/a:redhat:openshift:3.11::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20130169006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20130169005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "jenkins is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202017521001"
                  },
                  {
                    "Comment": "jenkins is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202017521002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "jenkins-2-plugins is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181000411001"
                  },
                  {
                    "Comment": "jenkins-2-plugins is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181000411002"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}