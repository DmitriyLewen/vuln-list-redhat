{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202342669",
  "Version": "636",
  "Metadata": {
    "Title": "\"rpcecho\" development server allows denial of service via sleep() call on AD DC (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-42669",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-42669"
      }
    ],
    "Description": "DOCUMENTATION: A vulnerability was found in Samba's \"rpcecho\" development server, a non-Windows RPC server used to test Samba's DCE/RPC stack elements. This vulnerability stems from an RPC function that can be blocked indefinitely. The issue arises because the \"rpcecho\" service operates with only one worker in the main RPC task, allowing calls to the \"rpcecho\" server to be blocked for a specified time, causing service disruptions. This disruption is triggered by a \"sleep()\" call in the \"dcesrv_echo_TestSleep()\" function under specific conditions. Authenticated users or attackers can exploit this vulnerability to make calls to the \"rpcecho\" server, requesting it to block for a specified duration, effectively disrupting most services and leading to a complete denial of service on the AD DC. The DoS affects all other services as \"rpcecho\" runs in the main RPC task. \n            \n            MITIGATION: To mitigate this vulnerability, disable rpcecho service on the AD DC by setting:\n~~~\ndcerpc endpoint servers = -rpcecho\n~~~",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2023-11-06"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-42669",
          "Cvss3": "6.5/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-400",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-42669",
          "Public": "20231010"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-client is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251021"
                  },
                  {
                    "Comment": "samba-client is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-samba-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127023"
                  },
                  {
                    "Comment": "python3-samba-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-usershares is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127041"
                  },
                  {
                    "Comment": "samba-usershares is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127042"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libnetapi is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127009"
                  },
                  {
                    "Comment": "libnetapi is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-dcerpc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127063"
                  },
                  {
                    "Comment": "samba-dcerpc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127064"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-vfs-iouring is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251001"
                  },
                  {
                    "Comment": "samba-vfs-iouring is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-ldb-ldap-modules is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127053"
                  },
                  {
                    "Comment": "samba-ldb-ldap-modules is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127054"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251053"
                  },
                  {
                    "Comment": "samba-winbind is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251054"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-common-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251027"
                  },
                  {
                    "Comment": "samba-common-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libnetapi-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127003"
                  },
                  {
                    "Comment": "libnetapi-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251003"
                  },
                  {
                    "Comment": "samba-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-dc-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127043"
                  },
                  {
                    "Comment": "samba-dc-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127044"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251009"
                  },
                  {
                    "Comment": "samba-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libwbclient-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251035"
                  },
                  {
                    "Comment": "libwbclient-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251036"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ctdb-tests is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251039"
                  },
                  {
                    "Comment": "ctdb-tests is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251040"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libwbclient is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251019"
                  },
                  {
                    "Comment": "libwbclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-samba-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251017"
                  },
                  {
                    "Comment": "python3-samba-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-client-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251041"
                  },
                  {
                    "Comment": "samba-client-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251042"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libsmbclient-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251011"
                  },
                  {
                    "Comment": "libsmbclient-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-test-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251049"
                  },
                  {
                    "Comment": "samba-test-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251050"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251029"
                  },
                  {
                    "Comment": "samba-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251051"
                  },
                  {
                    "Comment": "samba is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251052"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libsmbclient is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251047"
                  },
                  {
                    "Comment": "libsmbclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251048"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-modules is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251007"
                  },
                  {
                    "Comment": "samba-winbind-modules is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-tools is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127069"
                  },
                  {
                    "Comment": "samba-tools is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127070"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-samba is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251043"
                  },
                  {
                    "Comment": "python3-samba is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251044"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ctdb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251031"
                  },
                  {
                    "Comment": "ctdb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251032"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251033"
                  },
                  {
                    "Comment": "samba-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251034"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-clients is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251037"
                  },
                  {
                    "Comment": "samba-winbind-clients is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251038"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-krb5-printing is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251025"
                  },
                  {
                    "Comment": "samba-krb5-printing is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-pidl is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251013"
                  },
                  {
                    "Comment": "samba-pidl is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-krb5-locator is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251015"
                  },
                  {
                    "Comment": "samba-winbind-krb5-locator is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winexe is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251005"
                  },
                  {
                    "Comment": "samba-winexe is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-common-tools is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120251023"
                  },
                  {
                    "Comment": "samba-common-tools is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120251024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-samba-dc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222127015"
                  },
                  {
                    "Comment": "python3-samba-dc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222127016"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}