{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202432498",
  "Version": "636",
  "Metadata": {
    "Title": "OpenStack: malicious qcow2/vmdk images (critical)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-32498",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-32498"
      }
    ],
    "Description": "DOCUMENTATION: An input validation flaw was discovered in how multiple OpenStack services validate images with backing file references. An authenticated attacker could provide a malicious image via upload, or by creating and modifying an image from an existing volume. Validation of images can be triggered during image upload or when attaching images to virtual machines. During this process, the affected OpenStack services could be tricked into reading or writing to the host with the equivalent privileges of QEMU. This bypasses isolation restrictions, significantly reducing the security of an affected compute host, and could enable arbitrary code execution, a denial of service, or leaking of secrets. If exploited, the immediate impact is limited to an individual compute host. However, if the attacker has access to multiple hosts and enough time to repeat it, they could potentially spread across all compute hosts. \n            STATEMENT: The vast majority of deployments of Red Hat OpenStack Platform should be assumed to be vulnerable as they are likely to be using at least one of the impacted services: Compute (nova), Block Storage (cinder), and Image (glance).\n\nWhile an attacker must have valid login credentials to exploit this vulnerability, OpenStack supports multiple deployment scenarios with a variety of security postures. Open-cloud or multi-tenant deployments where infrastructure is shared by users who may be untrusted should treat this vulnerability as if it could be performed by an unauthenticated attacker. Considering this, along with the significant potential for disruption, we have rated the severity of this vulnerability as Critical.\n\nThe discovery of this vulnerability led to the discovery of an additional vulnerability (CVE-2024-4467) in QEMU. The impact to QEMU is significantly less as it is designed to only be run with trusted images. Red Hat OpenStack Platform is at a higher risk due from this underlying vulnerability, as OpenStack must tolerate running untrusted images.\n            MITIGATION: Red Hat has investigated whether a possible mitigation exists for this issue, and has not been able to identify a practical example. Please update the affected package as soon as possible.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Critical",
      "Issued": {},
      "Updated": {
        "Date": "2024-07-04"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-32498",
          "Cvss3": "8.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
          "Cwe": "CWE-20-\u003e(CWE-200|CWE-400)",
          "Impact": "critical",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-32498",
          "Public": "20240702:1500"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openstack:16.1",
        "cpe:/a:redhat:openstack:16.1::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20178761012"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20178761011"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-novncproxy is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394007"
                  },
                  {
                    "Comment": "openstack-nova-novncproxy is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-nova is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394015"
                  },
                  {
                    "Comment": "python3-nova is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-conductor is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394011"
                  },
                  {
                    "Comment": "openstack-nova-conductor is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-api is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394009"
                  },
                  {
                    "Comment": "openstack-nova-api is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394023"
                  },
                  {
                    "Comment": "openstack-nova-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-console is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394013"
                  },
                  {
                    "Comment": "openstack-nova-console is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-cinder is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202432498013"
                  },
                  {
                    "Comment": "python3-cinder is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202432498014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-glance is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20224134001"
                  },
                  {
                    "Comment": "python3-glance is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20224134002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-serialproxy is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394019"
                  },
                  {
                    "Comment": "openstack-nova-serialproxy is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-scheduler is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394017"
                  },
                  {
                    "Comment": "openstack-nova-scheduler is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394001"
                  },
                  {
                    "Comment": "openstack-nova is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-migration is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394021"
                  },
                  {
                    "Comment": "openstack-nova-migration is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-spicehtml5proxy is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394005"
                  },
                  {
                    "Comment": "openstack-nova-spicehtml5proxy is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-nova-compute is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202237394003"
                  },
                  {
                    "Comment": "openstack-nova-compute is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202237394004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-cinder is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202432498029"
                  },
                  {
                    "Comment": "openstack-cinder is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202432498030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openstack-glance is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20224134003"
                  },
                  {
                    "Comment": "openstack-glance is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20224134004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}