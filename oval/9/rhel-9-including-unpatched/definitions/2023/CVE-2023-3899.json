{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20233899",
  "Version": "636",
  "Metadata": {
    "Title": "inadequate authorization of com.redhat.RHSM1 D-Bus interface allows local users to modify configuration (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-3899",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-3899"
      }
    ],
    "Description": "DOCUMENTATION: A vulnerability was found in subscription-manager that allows local privilege escalation due to inadequate authorization. The D-Bus interface com.redhat.RHSM1 exposes a significant number of methods to all users that could change the state of the registration. By using the com.redhat.RHSM1.Config.SetAll() method, a low-privileged local user could tamper with the state of the registration, by unregistering the system or by changing the current entitlements. This flaw allows an attacker to set arbitrary configuration directives for /etc/rhsm/rhsm.conf, which can be abused to cause a local privilege escalation to an unconfined root. \n            STATEMENT: The vulnerable method SetAll() allows the non-root user to Local Privilege Escalation. The vulnerable method is present since subscription-manager-1.26.15-1. Currently, RHEL-8.2. and above contains the vulnerable code.\n\nHowever, before the SetAll() was introduced, the worst thing that could happen is to unregister the system and cut off system from updates. No privilege escalation is possible in RHEL-7.9, and RHEL-8.1 as those streams ships subscription-manager-1.25.17.1-1 and prior. Making it Moderate issue for those streams.\n\nSo, the vulnerability has always been there, the SetAll() method that introduced with later version in subscription-manager turned it to a to Local Privilege Escalation.\n            MITIGATION: A workaround is to mask rhsm.service using: \n\n```systemctl mask rhsm.service```\n\nWhen the rhsm.service is masked, then no D-Bus call cannot trigger the service and all D-Bus calls will be terminated with error: \"Call failed: Could not activate remote peer.\" But then all applications using D-Bus API will not work until you unmask the service using: \"systemctl unmask rhsm.service\"",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2023-08-22"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-3899",
          "Cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-285",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-3899",
          "Public": "20230822:1400"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:9",
        "cpe:/a:redhat:enterprise_linux:9::appstream",
        "cpe:/a:redhat:enterprise_linux:9::crb",
        "cpe:/a:redhat:enterprise_linux:9::highavailability",
        "cpe:/a:redhat:enterprise_linux:9::nfv",
        "cpe:/a:redhat:enterprise_linux:9::realtime",
        "cpe:/a:redhat:enterprise_linux:9::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:9::sap",
        "cpe:/a:redhat:enterprise_linux:9::sap_hana",
        "cpe:/a:redhat:enterprise_linux:9::supplementary",
        "cpe:/o:redhat:enterprise_linux:9",
        "cpe:/o:redhat:enterprise_linux:9::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "subscription-manager-rhsm-certificates is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20233899001"
                  },
                  {
                    "Comment": "subscription-manager-rhsm-certificates is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20233899002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "subscription-manager-plugin-ostree is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20233899003"
                  },
                  {
                    "Comment": "subscription-manager-plugin-ostree is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20233899004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "subscription-manager-cockpit is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20233899005"
                  },
                  {
                    "Comment": "subscription-manager-cockpit is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20233899006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-cloud-what is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20233899007"
                  },
                  {
                    "Comment": "python3-cloud-what is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20233899008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-subscription-manager-rhsm is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20233899009"
                  },
                  {
                    "Comment": "python3-subscription-manager-rhsm is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20233899010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rhsm-icons is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20233899011"
                  },
                  {
                    "Comment": "rhsm-icons is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20233899012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libdnf-plugin-subscription-manager is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20233899013"
                  },
                  {
                    "Comment": "libdnf-plugin-subscription-manager is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20233899014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "subscription-manager is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20233899015"
                  },
                  {
                    "Comment": "subscription-manager is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20233899016"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}