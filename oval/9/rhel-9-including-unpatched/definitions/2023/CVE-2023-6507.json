{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20236507",
  "Version": "636",
  "Metadata": {
    "Title": "python: Improper privileges drop on subprocess module (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-6507",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-6507"
      }
    ],
    "Description": "DOCUMENTATION: The MITRE CVE dictionary describes this issue as: An issue was found in CPython 3.12.0 `subprocess` module on POSIX platforms. The issue was fixed in CPython 3.12.1 and does not affect other stable releases.\n\nWhen using the `extra_groups=` parameter with an empty list as a value (ie `extra_groups=[]`) the logic regressed to not call `setgroups(0, NULL)` before calling `exec()`, thus not dropping the original processes' groups before starting the new process. There is no issue when the parameter isn't used or when any value is used besides an empty list.\n\nThis issue only impacts CPython processes run with sufficient privilege to make the `setgroups` system call (typically `root`).",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-06-24"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-6507",
          "Cvss3": "6.1/CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N",
          "Cwe": "CWE-271",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-6507",
          "Public": "20231208"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:9",
        "cpe:/a:redhat:enterprise_linux:9::appstream",
        "cpe:/a:redhat:enterprise_linux:9::crb",
        "cpe:/a:redhat:enterprise_linux:9::highavailability",
        "cpe:/a:redhat:enterprise_linux:9::nfv",
        "cpe:/a:redhat:enterprise_linux:9::realtime",
        "cpe:/a:redhat:enterprise_linux:9::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:9::sap",
        "cpe:/a:redhat:enterprise_linux:9::sap_hana",
        "cpe:/a:redhat:enterprise_linux:9::supplementary",
        "cpe:/o:redhat:enterprise_linux:9",
        "cpe:/o:redhat:enterprise_linux:9::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.11-idle is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202336632009"
                  },
                  {
                    "Comment": "python3.11-idle is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202336632010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.11-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202336632019"
                  },
                  {
                    "Comment": "python3.11-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202336632020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.12 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20236507005"
                  },
                  {
                    "Comment": "python3.12 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20236507006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.12-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20236507007"
                  },
                  {
                    "Comment": "python3.12-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20236507008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336005"
                  },
                  {
                    "Comment": "python3-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.11-tkinter is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202336632027"
                  },
                  {
                    "Comment": "python3.11-tkinter is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202336632028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336011"
                  },
                  {
                    "Comment": "python3-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.12-debug is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20236507015"
                  },
                  {
                    "Comment": "python3.12-debug is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20236507016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.12-idle is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20236507017"
                  },
                  {
                    "Comment": "python3.12-idle is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20236507018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-debug is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336013"
                  },
                  {
                    "Comment": "python3-debug is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-idle is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336007"
                  },
                  {
                    "Comment": "python3-idle is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.11-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202336632025"
                  },
                  {
                    "Comment": "python3.11-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202336632026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.11-debug is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202336632017"
                  },
                  {
                    "Comment": "python3.11-debug is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202336632018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336001"
                  },
                  {
                    "Comment": "python3 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-tkinter is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336003"
                  },
                  {
                    "Comment": "python3-tkinter is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-unversioned-command is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336009"
                  },
                  {
                    "Comment": "python-unversioned-command is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.12-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20236507033"
                  },
                  {
                    "Comment": "python3.12-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20236507034"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.12-tkinter is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20236507035"
                  },
                  {
                    "Comment": "python3.12-tkinter is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20236507036"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336015"
                  },
                  {
                    "Comment": "python3-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.12-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20236507039"
                  },
                  {
                    "Comment": "python3.12-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20236507040"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.9 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202123336017"
                  },
                  {
                    "Comment": "python3.9 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202123336018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.11-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202336632011"
                  },
                  {
                    "Comment": "python3.11-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202336632012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3.11 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202336632015"
                  },
                  {
                    "Comment": "python3.11 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202336632016"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}