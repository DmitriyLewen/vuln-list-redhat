{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20243183",
  "Version": "636",
  "Metadata": {
    "Title": "freeipa: user can obtain a hash of the passwords of all domain users and perform offline brute force (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-3183",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-3183"
      }
    ],
    "Description": "DOCUMENTATION: A vulnerability was found in FreeIPA in a way when a Kerberos TGS-REQ is encrypted using the client’s session key. This key is different for each new session, which protects it from brute force attacks. However, the ticket it contains is encrypted using the target principal key directly. For user principals, this key is a hash of a public per-principal randomly-generated salt and the user’s password.\n\nIf a principal is compromised it means the attacker would be able to retrieve tickets encrypted to any principal, all of them being encrypted by their own key directly. By taking these tickets and salts offline, the attacker could run brute force attacks to find character strings able to decrypt tickets when combined to a principal salt (i.e. find the principal’s password). \n            STATEMENT: This kind of attacks primarily affect user principals, not service principals because their keys are usually generated randomly. But weak user passwords are particularly vulnerable to such attacks, especially if they are referenced in password dictionaries.\n            MITIGATION: To mitigate this vulnerability, ticket requests to user principals are now disallowed in FreeIPA realms by default. This will keep attackers from obtaining data encrypted with the user key directly.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2024-06-10"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-3183",
          "Cvss3": "8.1/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
          "Cwe": "CWE-916",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-3183",
          "Public": "20240610"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:9",
        "cpe:/a:redhat:enterprise_linux:9::appstream",
        "cpe:/a:redhat:enterprise_linux:9::crb",
        "cpe:/a:redhat:enterprise_linux:9::highavailability",
        "cpe:/a:redhat:enterprise_linux:9::nfv",
        "cpe:/a:redhat:enterprise_linux:9::realtime",
        "cpe:/a:redhat:enterprise_linux:9::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:9::sap",
        "cpe:/a:redhat:enterprise_linux:9::sap_hana",
        "cpe:/a:redhat:enterprise_linux:9::supplementary",
        "cpe:/o:redhat:enterprise_linux:9",
        "cpe:/o:redhat:enterprise_linux:9::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-ipalib is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698001"
                  },
                  {
                    "Comment": "python3-ipalib is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-selinux is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698003"
                  },
                  {
                    "Comment": "ipa-selinux is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-ipaserver is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698005"
                  },
                  {
                    "Comment": "python3-ipaserver is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-server-dns is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698007"
                  },
                  {
                    "Comment": "ipa-server-dns is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-server-trust-ad is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698009"
                  },
                  {
                    "Comment": "ipa-server-trust-ad is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-client-samba is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698011"
                  },
                  {
                    "Comment": "ipa-client-samba is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-server-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698013"
                  },
                  {
                    "Comment": "ipa-server-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-client-epn is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698015"
                  },
                  {
                    "Comment": "ipa-client-epn is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-ipaclient is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698017"
                  },
                  {
                    "Comment": "python3-ipaclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698019"
                  },
                  {
                    "Comment": "ipa-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-client-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698021"
                  },
                  {
                    "Comment": "ipa-client-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698023"
                  },
                  {
                    "Comment": "ipa-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698025"
                  },
                  {
                    "Comment": "ipa is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ipa-client is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698027"
                  },
                  {
                    "Comment": "ipa-client is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-ipatests is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20242698029"
                  },
                  {
                    "Comment": "python3-ipatests is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20242698030"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}