{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20246387",
  "Version": "636",
  "Metadata": {
    "Title": "openssh: Possible remote code execution due to a race condition in signal handling (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-6387",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-6387"
      }
    ],
    "Description": "DOCUMENTATION: A signal handler race condition was found in OpenSSH's server (sshd), where a client does not authenticate within LoginGraceTime seconds (120 by default, 600 in old OpenSSH versions), then sshd's SIGALRM handler is called asynchronously. However, this signal handler calls various functions that are not async-signal-safe, for example, syslog(). \n            STATEMENT: Only Red Hat Enterprise Linux 9 is affected. This flaw doesnâ€™t affected OpenSSH versions as shipped with Red Hat Enterprise Linux 8 as the vulnerable code was introduced in later OpenSSH version in upstream and was never backported to Red Hat Enterprise Linux 8.\n\nRed Hat has rated this flaw with the severity of Important. Although the possibility of remote code execution, the complexity to achieve that is very high and time consuming due to the need of wining a race condition. If the attacker doesn't achieve such win, the most likely outcome is to have the sshd server to crash, generating only the availability impact. In order to achieve the condition mentioned before a huge amount of connections to the targeted server may be needed, which may eventually be easily notice via network monitoring tools.\n            MITIGATION: This issue can be mitigated by setting the LoginGraceTime parameter to 0 in the sshd configuration file.\n\n1) As root user, open the /etc/ssh/sshd_config\n2) Add or edit the parameter configuration:\n~~~\nLoginGraceTime 0\n~~~\n3) Save and close the file\n4) Restart the sshd daemon:\n~~~\nsystemctl restart sshd.service\n~~~\n\nNotice the sshd server will still be vulnerable to Denial of Service attacks due to the possibility os MaxStartups connection exhaustion, however it'll be safe against possible remote code execution attacks.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2024-07-02"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-6387",
          "Cvss3": "8.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-364",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-6387",
          "Public": "20240701:0800"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:9",
        "cpe:/a:redhat:enterprise_linux:9::appstream",
        "cpe:/a:redhat:enterprise_linux:9::crb",
        "cpe:/a:redhat:enterprise_linux:9::highavailability",
        "cpe:/a:redhat:enterprise_linux:9::nfv",
        "cpe:/a:redhat:enterprise_linux:9::realtime",
        "cpe:/a:redhat:enterprise_linux:9::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:9::sap",
        "cpe:/a:redhat:enterprise_linux:9::sap_hana",
        "cpe:/a:redhat:enterprise_linux:9::supplementary",
        "cpe:/o:redhat:enterprise_linux:9",
        "cpe:/o:redhat:enterprise_linux:9::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-askpass is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201620012009"
                  },
                  {
                    "Comment": "openssh-askpass is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201620012010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201620012005"
                  },
                  {
                    "Comment": "openssh-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201620012006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-keycat is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201620012001"
                  },
                  {
                    "Comment": "openssh-keycat is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201620012002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-clients is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201620012003"
                  },
                  {
                    "Comment": "openssh-clients is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201620012004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "pam_ssh_agent_auth is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201620012007"
                  },
                  {
                    "Comment": "pam_ssh_agent_auth is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201620012008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201620012011"
                  },
                  {
                    "Comment": "openssh is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201620012012"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}