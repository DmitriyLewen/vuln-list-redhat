{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202423652",
  "Version": "636",
  "Metadata": {
    "Title": "moby/buildkit: possible host system access from mount stub cleaner (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-23652",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-23652"
      }
    ],
    "Description": "DOCUMENTATION: A vulnerability was found in the Moby Builder Toolkit, which arose from BuildKit's attempts to clean up temporarily added directories after use. A malicious BuildKit frontend or Dockerfile using RUN --mount could deceive the feature responsible for removing empty files created for the mount points, potentially leading to removing a file outside the container and affecting the host system. Successful exploitation of this issue may result in the arbitrary deletion of files and directories on the underlying host OS when building an image using a malicious Dockerfile or upstream image (for example, when using FROM). \n            STATEMENT: This vulnerability can only be exploited when a container is built using a Dockerfile or BuildKit frontend with a RUN --mount command. Additionally, the parent of the target directory needs to be replaced with a symbolic link during the build container's lifetime for the cleanup operations reach the host file system. For these reasons, this flaw was rated with an important severity.\n            MITIGATION: Do not use BuildKit frontends or Dockerfiles from untrusted sources.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2024-02-01"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-23652",
          "Cvss3": "7.4/CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:H",
          "Cwe": "CWE-22",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-23652",
          "Public": "20240131"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.16",
        "cpe:/a:redhat:openshift:4.16::el9"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201714623004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201714623003"
          },
          {
            "Comment": "openshift-clients is installed",
            "TestRef": "oval:com.redhat.cve:tst:201714623001"
          },
          {
            "Comment": "openshift-clients is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:201714623002"
          }
        ]
      }
    ]
  }
}